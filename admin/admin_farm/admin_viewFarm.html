<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Available Farms</title>
        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
        <style>
            /* General Reset for padding and margin */
            * {
                box-sizing: border-box;
            }

            /* Boxed layout for content */
            .content-box {
                background-color: #ffffff;
                padding: 30px;
                border-radius: 10px;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                margin-top: 20px;
            }

            /* Optional: Additional styling for table */
            .table-wrapper {
                margin-top: 20px;
            }

            /* Styling for table headers */
            th {
                background-color: #f8f9fa;
            }

            /* Styling for the page heading */
            h2 {
                font-size: 24px;
                font-weight: 600;
            }

            h4 {
                font-size: 18px;
                font-weight: 500;
            }

            /* Flex styling for title and button */
            .title-bar {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 20px;
            }

            /* Styling for button */
            .request-button {
                background-color: #343a40; /* Dark similar to btn-dark */
                color: white;
                font-size: 16px;
                padding: 10px 20px;
                border: none;
                cursor: pointer;
            }

            .request-button:hover {
                background-color: #23272b; /* Darker shade on hover */
            }
        </style>
    </head>
    <body>

        <div class="container my-4">
            <div class="content-box">
                <div class="title-bar">
                    <h3>Farm List</h3>
                </div>    

                <!-- Show entries dropdown -->
                <div class="d-flex justify-content-between align-items-center my-3">
                    <div>
                        <label>Show 
                            <select class="form-select form-select-sm d-inline w-auto">
                                <option value="10">10</option>
                                <option value="25">25</option>
                                <option value="50">50</option>
                                <option value="100">100</option>
                            </select>
                            entries
                        </label>
                    </div>
                    <!-- Button to trigger modal -->
                    <button class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#addFarmlModal">Add Farm</button>
                </div>

                <div class="table-wrapper">
                    <table class="table table-bordered table-striped">
                        <thead class="table-light">
                            <tr>
                                <th>Farm ID</th>
                                <th>Farm Name</th>
                                <th>Location</th>
                                <th>Size</th>
                                <th>Water Source</th>
                                <th>Plot Size</th>
                                <th>Plot Type</th>
                                <th>Soil Type</th>
                                <th>Soil Condition</th>
                                <th>Status</th>
                                <th>Edit</th>
                                <th>Delete</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Example Data -->
                            <tr>
                                <td>001</td>
                                <td>Greenhand Farm</td>
                                <td>Johor</td>
                                <td>50 ha</td>
                                <td>River</td>
                                <td>10 ha</td>
                                <td>Agricultural</td>
                                <td>Sand</td>
                                <td>Good</td>
                                <td class="text-success">Occupied</td>
                                <td>
                                    <button class="btn btn-primary btn-sm edit-btn" data-bs-toggle="modal" data-bs-target="#editFarmModal">Edit</button>
                                </td>
                                <td>
                                    <button class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#deleteFarmModal">Delete</button>
                                
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- Pagination -->
                    <div class="d-flex justify-content-between align-items-center mt-3">
                        <div>Showing 1 to 10 of 31 entries</div>
                        <nav>
                            <ul class="pagination mb-0">
                                <li class="page-item"><a class="page-link" href="#">Previous</a></li>
                                <li class="page-item active"><a class="page-link" href="#">1</a></li><li class="page-item"><a class="page-link" href="#">2</a></li>
                                <li class="page-item"><a class="page-link" href="#">Next</a></li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Farm Modal -->
        <div class="modal fade" id="addFarmlModal" tabindex="-1" aria-labelledby="addFarmModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addFarmModalLabel">Add Farm</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="addFarmForm">
                            <div class="mb-3">
                                <label for="farmName" class="form-label">Farm Name</label>
                                <input type="text" class="form-control" id="farmName" name="farmName" required>
                            </div>
                            <div class="mb-3">
                                <label for="location" class="form-label">Location</label>
                                <input type="text" class="form-control" id="location" name="location" required>
                            </div>
                            <div class="mb-3">
                                <label for="size" class="form-label">Size</label>
                                <input type="text" class="form-control" id="size" name="size" required>
                            </div>
                            <div class="mb-3">
                                <label for="waterSource" class="form-label">Water Source</label>
                                <input type="text" class="form-control" id="waterSource" name="waterSource" required>
                            </div>
                            <div class="mb-3">
                                <label for="plotSize" class="form-label">Plot Size</label>
                                <input type="text" class="form-control" id="plotSize" name="plotSize"  required>
                            </div>
                            <div class="mb-3">
                                <label for="plotType" class="form-label">Plot Type</label>
                                <input type="text" class="form-control" id="plotType" name="plotType" required>
                            </div>
                            <div class="mb-3">
                                <label for="soilCondition" class="form-label">Soil Condition</label>
                                <input type="text" class="form-control" id="soilCondition" name="soilCondition" required>
                            </div>
                            <div class="mb-3">
                                <label for="status" class="form-label">Status</label>
                                <select class="form-select" id="status" name="status">
                                    <option value="Available">Available</option>
                                    <option value="Occupied">Occupied</option>
                                </select>
                            </div>
                            
                            <div class="d-flex justify-content-end">
                                <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">Cancel</button>
                                <button type="submit" class="btn btn-dark">Add Booking</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Edit Farm Modal -->
        <div class="modal fade" id="editFarmModal" tabindex="-1" aria-labelledby="editFarmModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="editFarmModalLabel">Edit Farm</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="editFarmForm">
                            <input type="hidden" id="editFarmId">

                            <div class="mb-3">
                                <label for="editFarmName" class="form-label">Farm Name</label>
                                <input type="text" class="form-control" id="editFarmName" name="farmName" required>
                            </div>
                            <div class="mb-3">
                                <label for="editLocation" class="form-label">Location</label>
                                <input type="text" class="form-control" id="editLocation" name="location" required>
                            </div>
                            <div class="mb-3">
                                <label for="editSize" class="form-label">Size</label>
                                <input type="text" class="form-control" id="editSize" name="size" required>
                            </div>
                            <div class="mb-3">
                                <label for="editWaterSource" class="form-label">Water Source</label>
                                <input type="text" class="form-control" id="editWaterSource" name="waterSource">
                            </div>
                            <div class="mb-3">
                                <label for="editPlotSize" class="form-label">Plot Size</label>
                                <input type="text" class="form-control" id="editPlotSize" name="plotSize"  required>
                            </div>
                            <div class="mb-3">
                                <label for="editPlotType" class="form-label">Plot Type</label>
                                <input type="text" class="form-control" id="editPlotType" name="plotType" required>
                            </div>
                            <div class="mb-3">
                                <label for="editSoilCondition" class="form-label">Soil Condition</label>
                                <input type="text" class="form-control" id="editSoilCondition" name="soilCondition" required>
                            </div>
                            <div class="mb-3">
                                <label for="editStatus" class="form-label">Status</label>
                                <select class="form-select" id="editStatus" name="status">
                                    <option value="Available">Available</option>
                                    <option value="Occupied">Occupied</option>
                                </select>
                            </div>

                            <div class="d-flex justify-content-end">
                                <button type="submit" class="btn btn-primary">Save Changes</button>
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Delete Farm Modal -->
        <div class="modal fade" id="deleteFarmModal" tabindex="-1" aria-labelledby="deleteFarmModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deleteFarmModalLabel">Delete Farm</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>Are you sure you want to delete this farm?</p>
                        <button type="button" class="btn btn-danger" id="confirmDelete">Delete</button>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
        
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                // Add farm event listener
                document.getElementById("addFarmForm").addEventListener("submit", function (e) {
                    e.preventDefault();

                    // Get form inputs
                    const farmId = "GeneratedID"; 
                    const farmName = document.getElementById("farmName").value;
                    const location = document.getElementById("location").value;
                    const size = document.getElementById("size").value;
                    const waterSource = document.getElementById("waterSource").value;
                    const plotSize = document.getElementById("plotSize").value;
                    const plotType = document.getElementById("plotType").value;
                    const soilCondition = document.getElementById("soilCondition").value;
                    const status = document.getElementById("status").value;

                    // Create a new row
                    const table = document.querySelector("table tbody");
                    const newRow = document.createElement("tr");
                    newRow.innerHTML = `
                        <td>${farmId}</td>
                        <td>${farmName}</td>
                        <td>${location}</td>
                        <td>${size}</td>
                        <td>${waterSource}</td>
                        <td>${plotSize}</td>
                        <td>${plotType}</td>
                        <td>${soilCondition}</td>
                        <td class="text-${status === "Occupied" ? "success" : "danger"}">${status}</td>
                        <td>
                            <button class="btn btn-primary btn-sm edit-btn" data-bs-toggle="modal" data-bs-target="#editFarmModal">Edit</button>
                            <button class="btn btn-danger btn-sm delete-btn" data-bs-toggle="modal" data-bs-target="#deleteFarmModal">Delete</button>
                        </td>
                    `;
                    table.appendChild(newRow);

                    // Clear form inputs
                    document.getElementById("addFarmForm").reset();

                    
                });
            });
            
            // Handle editing the farm
            document.addEventListener("click", function (e) {
                if (e.target.classList.contains("edit-btn")) {
                    const row = e.target.closest("tr");
                    const farmId = row.cells[0].textContent;
                    const farmName = row.cells[1].textContent;
                    const location = row.cells[2].textContent;
                    const size = row.cells[3].textContent;
                    const waterSource = row.cells[4].textContent;
                    const plotSize = row.cells[5].textContent;
                    const plotType = row.cells[6].textContent;
                    const soilCondition = row.cells[7].textContent;
                    const status = row.cells[8].textContent.trim();

                    document.getElementById("editFarmId").value = farmId;
                    document.getElementById("editFarmName").value = farmName;
                    document.getElementById("editLocation").value = location;
                    document.getElementById("editSize").value = size;
                    document.getElementById("editWaterSource").value = waterSource;
                    document.getElementById("editPlotSize").value = plotSize;
                    document.getElementById("editPlotType").value = plotType;
                    document.getElementById("editSoilCondition").value = soilCondition;
                    document.getElementById("editStatus").value = status;
                }
            });


            // Handle form submission for editing
            document.getElementById("editFarmForm").addEventListener("submit", function (e) {
                e.preventDefault();

                // Update row with edited values
                const farmId = document.getElementById("editFarmId").value;
                const farmName = document.getElementById("editFarmName").value;
                const location = document.getElementById("editLocation").value;
                const size = document.getElementById("editSize").value;
                const waterSource = document.getElementById("editWaterSource").value;
                const plotSize = document.getElementById("editPlotSize").value;
                const plotType = document.getElementById("editPlotType").value;
                const soilCondition = document.getElementById("editSoilCondition").value;
                const status = document.getElementById("editStatus").value;

                // Find the correct row to update
                const rows = document.querySelectorAll("table tbody tr");
                rows.forEach((row) => {
                    const rowFarmId = row.querySelector("td").innerText;
                    if (rowFarmId === farmId) {
                        const cells = row.querySelectorAll("td");
                        cells[1].innerText = farmName;
                        cells[2].innerText = location;
                        cells[3].innerText = size;
                        cells[4].innerText = waterSource;
                        cells[5].innerText = plotSize;
                        cells[6].innerText = plotType;
                        cells[7].innerText = soilCondition;
                        cells[9].innerText = status;
                        }
                });

                // Tutup modal
                const editModal = document.getElementById("editFarmModal");
                const modalInstance = bootstrap.Modal.getInstance(editModal);
                modalInstance.hide();
                    
            });

            // Delete farm
            document.addEventListener("click", function (e) {
                if (e.target.classList.contains("delete-btn")) {
                    const row = e.target.closest("tr");
                    const farmId = row.cells[0].textContent;
                    document.getElementById("deleteFarmId").value = farmId;
                }
            });

            // Delete booking upon confirmation
            document.getElementById("deleteFarmForm").addEventListener("submit", function (e) {
                e.preventDefault();

                const farmId = document.getElementById("deleteFarmId").value;
                
                // Find and remove the row from the table
                const rows = document.querySelectorAll("table tbody tr");
                rows.forEach(row => {
                    if (row.cells[0].textContent === farmId) {
                        row.remove();
                    }
                });

                // Close the modal
                const deleteModal = bootstrap.Modal.getInstance(document.getElementById("deleteFarmModal"));
                    eleteModal.hide();
            });
            

        </script>
        
    </body>
</html>
